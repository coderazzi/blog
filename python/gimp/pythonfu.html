<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>A PythonFu example</title>
<meta name="Description" content="A PythonFu example">
<meta name="Keywords" content="PythonFu css image-map">

<link rel="stylesheet" type="text/css" href="../../css/global.css">
<link rel="stylesheet" type="text/css" href="../../css/sunburst.css">
<link rel="stylesheet" type="text/css" href="pythonfu.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script type="text/javascript" src='pythonfu.js'></script>
</head>

<body>
 <div id='body'>
 <div id='content'>

 <h1>A PythonFu example</h1>
<p>To manipulate images, I normally use <a href='http://www.imagemagick.org/script/index.php'>ImageMagick</a> 
	or the <a href='http://www.gimp.org/'>GIMP</a>. 
	The former usually on my server web applications, as part of some automation script, and the later covering almost any situation.
	One feature that makes GIMP much more powerful is its possibility to run scripts, or plugins, 
	written in python or scheme; this is specially interesting to perform repetitive tasks (like in plugins), 
	but also to create programmatically specific images.</p>

<p>Next image, for example, is a great candidate for programmed generation; I use this image in a web application as am html image map:
	the user can choose any of the circles on the image, which represent areas on the screen. Using image map plus css and javascript, 
	each circle can be alternatively highlighted, as this examples shows -the used html and css are listed below-.</p>

<div id='img_wrap'>
	<div id="map_div" class='span-2 last'>
		<a href="#" id='map_div_top_left'></a>
		<a href="#" id='map_div_top'></a>
		<a href="#" id='map_div_top_right'></a>
		<a href="#" id='map_div_left'></a>
		<a href="#" id='map_div_center'></a>
		<a href="#" id='map_div_right'></a>
		<a href="#" id='map_div_bottom_left'></a>
		<a href="#" id='map_div_bottom'></a>
		<a href="#" id='map_div_bottom_right'></a>
	</div>
	<img id='img_map_div' src='pfu.png'>
</div>

<p>The main problem using PythonFu is the documentation. This <a href='http://www.gimp.org/docs/python/index.html'>document</a> 
	is probably the best resource, but in most cases, writing an script implies a lot of try an error.
	Seeing available examples is in my opinion the best help that I have found on PythonFu, and that is the reason why I am 
	including my own basic example in this page (with the hope of extending it later). One more thing: making tasks more complicated, 
	some of the procedures available to PythonFu seem to change continuously. For example, the initial script I wrote, targetting a 
	GIMP 2.6 installation, used the methods pdb.gimp_image_insert_layer and pdb.gimp_image_select_ellipse; 
	running the original script in my current GIMP 2.8 installation complains on those methods, 
	so I had to replace it with the available ones: pdb.gimp_ellipse_select and pdb.gimp_image_add_layer
	(with different number of arguments!).</p>

<p>To start PythonFu, go in GIMP to Filters -> PythonFu -> Console. At some time, not really short, a window will appear showing 
	the python console. The help normally refers to the online documentation, available -for 2.8-, 
	<a href='http://docs.gimp.org/2.8/en/gimp-filters-python-fu.html'>here</a>. A bigger help is available directly on the 
	PythonFu console; the browse button opens the procedure browser, that provides information on the commands available for the 
	script. Now it is just a matter of matching the operation to perform with the right python function.</p>

<p>The following script creates the image shown above. The constant SIZE defines the size of the image, square, as the number of pixels 
	of each side, while the constant RADIO defines the radio of each circle. Here is the full script, conveniently documented. 
	To execute, just paste it on the python console.</p>

<h2>pythonfu.py</h2>
<a href='pythonfu.py'>Download</a>

<!-- Here comes the code from prettify -->
<pre class="prettyprint"><span class="kwd">import</span><span class="pln"> gimpfu </span><span class="com">#access constants</span><span class="pln">

SIZE</span><span class="pun">=</span><span class="lit">240</span><span class="pln">
RADIO</span><span class="pun">=</span><span class="lit">24</span><span class="pln">

</span><span class="com">#create the image</span><span class="pln">
img</span><span class="pun">=</span><span class="pln">pdb</span><span class="pun">.</span><span class="pln">gimp_image_new</span><span class="pun">(</span><span class="pln">SIZE</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">,</span><span class="pln"> gimpfu</span><span class="pun">.</span><span class="pln">RGB</span><span class="pun">)</span><span class="pln">

</span><span class="com">#add layer with 100% of opacity</span><span class="pln">
layer</span><span class="pun">=</span><span class="pln">pdb</span><span class="pun">.</span><span class="pln">gimp_layer_new</span><span class="pun">(</span><span class="pln">img</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">,</span><span class="pln"> gimpfu</span><span class="pun">.</span><span class="pln">RGB_IMAGE</span><span class="pun">,</span><span class="pln"> </span><span class="str">"base"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">100</span><span class="pun">,</span><span class="pln"> gimpfu</span><span class="pun">.</span><span class="pln">NORMAL_MODE</span><span class="pun">)</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_image_add_layer</span><span class="pun">(</span><span class="pln">img</span><span class="pun">,</span><span class="pln"> layer</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">

</span><span class="com">#we need it with alpha channel</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_layer_add_alpha</span><span class="pun">(</span><span class="pln">layer</span><span class="pun">)</span><span class="pln">

</span><span class="com">#access its drawable</span><span class="pln">
drw </span><span class="pun">=</span><span class="pln"> pdb</span><span class="pun">.</span><span class="pln">gimp_image_active_drawable</span><span class="pun">(</span><span class="pln">img</span><span class="pun">)</span><span class="pln">

</span><span class="com">#set background to black, and foreground to white</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_context_set_background</span><span class="pun">((</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">))</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_context_set_foreground</span><span class="pun">((</span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">,</span><span class="pln"> </span><span class="lit">255</span><span class="pun">))</span><span class="pln">

</span><span class="com">#fill the background - black</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_drawable_fill</span><span class="pun">(</span><span class="pln">drw</span><span class="pun">,</span><span class="pln"> gimpfu</span><span class="pun">.</span><span class="pln">BACKGROUND_FILL</span><span class="pun">)</span><span class="pln">

</span><span class="com">#to set the brush, check first for available brushes using  pdb.gimp_brushes_get_list("")</span><span class="pln">
</span><span class="com">#Exanples of brush with width 3 is '1. Pixel', and with width 1, 'Pixel (1x1 square)'</span><span class="pln">

</span><span class="com">#set brush to simple pixel (width: 1)</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_context_set_brush</span><span class="pun">(</span><span class="str">'Circle (01)'</span><span class="pun">)</span><span class="pln">

</span><span class="com">#draw a square around the image</span><span class="pln">
ctrlPoints </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> 
              SIZE</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">]</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_paintbrush_default</span><span class="pun">(</span><span class="pln">drw</span><span class="pun">,</span><span class="pln">len</span><span class="pun">(</span><span class="pln">ctrlPoints</span><span class="pun">),</span><span class="pln">ctrlPoints</span><span class="pun">)</span><span class="pln">

</span><span class="com">#now we draw 9 transparent circles (3 rows x 3 columns)</span><span class="pln">
</span><span class="com">#a transparent circle means -with an alpha layer-, to select the area and cut it</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">/</span><span class="lit">2</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">RADIO</span><span class="pun">):</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> y </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">/</span><span class="lit">2</span><span class="pun">-</span><span class="pln">RADIO</span><span class="pun">,</span><span class="pln"> SIZE</span><span class="pun">-</span><span class="lit">2</span><span class="pun">*</span><span class="pln">RADIO</span><span class="pun">):</span><span class="pln">
		</span><span class="com">#next call was available on 2.6, not on 2.8</span><span class="pln">
		</span><span class="com">#pdb.gimp_image_select_ellipse(img, gimpfu.CHANNEL_OP_REPLACE, </span><span class="pln">
		</span><span class="com">#                              x, y, RADIO*2, RADIO*2)</span><span class="pln">
		pdb</span><span class="pun">.</span><span class="pln">gimp_ellipse_select</span><span class="pun">(</span><span class="pln">img</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">*</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> RADIO</span><span class="pun">*</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> 
		                        gimpfu</span><span class="pun">.</span><span class="pln">CHANNEL_OP_REPLACE</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
		pdb</span><span class="pun">.</span><span class="pln">gimp_edit_cut</span><span class="pun">(</span><span class="pln">drw</span><span class="pun">)</span><span class="pln">

</span><span class="com">#remove any selection</span><span class="pln">
pdb</span><span class="pun">.</span><span class="pln">gimp_selection_none</span><span class="pun">(</span><span class="pln">img</span><span class="pun">)</span><span class="pln">

</span><span class="com">#and display the image</span><span class="pln">
display</span><span class="pun">=</span><span class="pln">pdb</span><span class="pun">.</span><span class="pln">gimp_display_new</span><span class="pun">(</span><span class="pln">img</span><span class="pun">)</span></pre>
<!--Here ends the prettify code-->

<p>To obtain the result shown above, the image is handled as a image map with the following html code:</p>

<!-- Here comes the code from prettify -->
<pre class="prettyprint"><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'img_wrap'</span><span class="tag">&gt;</span><span class="pln">
	</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"map_div"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">'span-2 last'</span><span class="tag">&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_top_left'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_top'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_top_right'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_left'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_center'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_right'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_bottom_left'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_bottom'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
		</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"#"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'map_div_bottom_right'</span><span class="tag">&gt;&lt;/a&gt;</span><span class="pln">
	</span><span class="tag">&lt;/div&gt;</span><span class="pln">
	</span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">'img_map_div'</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">'pfu.png'</span><span class="tag">&gt;</span><span class="pln">
</span><span class="tag">&lt;/div&gt;</span></pre>

<!--Here ends the prettify code-->

<p>That requires these css definitions:</p>
<pre class='prettyprint'><span class="atn">
#img_wrap{
	display: block;
	background:black;
	width:300px;
	height:300px;	
	margin-left: auto;
	margin-right: auto;
	position:relative;
}
#map_div{
	top:30px;
	left:30px;
	width:240px;
	height:240px;
	position:relative;
	background: yellow;
	/*background:white url(pfu.png);*/
}
#img_map_div{
	top:30px;
	left:30px;
	width:240px;
	height:240px;
	position:absolute;
	z-index:5;
	pointer-events:none;
}

#map_div a{ display:block; position:absolute; }
#map_div a#map_div_top_left{width:48px; height:48px; top:0px; left:0px;}
#map_div a#map_div_top{ width:48px; height:48px; top:0px; left:96px;}
#map_div a#map_div_top_right{width:48px;height:48px; top:0px; left:192px;}
#map_div a#map_div_left{width:48px; height:48px; top:96px; left:0px;}
#map_div a#map_div_center{width:48px;	height:48px; top:96px; left:96px;}
#map_div a#map_div_right{width:48px;height:48px; top:96px; left:192px;}
#map_div a#map_div_bottom_left{width:48px; height:48px; top:192px; left:0px;}
#map_div a#map_div_bottom{width:48px; height:48px; top:192px; left:96px;}
#map_div a#map_div_bottom_right{width:48px; height:48px; top:192px; left:192px;}  
</span></pre>

<p>Finally, the javascript code to handle the mouse hovering and selection:</p>
<h2>pythonfu.js</h2>
<a href='pythonfu.js'>Download</a>

<!-- Here comes the code from prettify -->
<pre class="prettyprint"><span class="pln">$</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> SIDE</span><span class="pun">=</span><span class="lit">240</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> RADIO</span><span class="pun">=</span><span class="lit">24</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> SELECTED_COLOR</span><span class="pun">=</span><span class="str">'#5Bc5fF'</span><span class="pun">,</span><span class="pln"> HOVER_COLOR</span><span class="pun">=</span><span class="str">'blue'</span><span class="pun">,</span><span class="pln"> NONE_COLOR</span><span class="pun">=</span><span class="str">'yellow'</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">var</span><span class="pln"> sectionSize </span><span class="pun">=</span><span class="pln"> SIDE </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> RADIO</span><span class="pun">,</span><span class="pln"> diameter </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> RADIO</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> selected </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> hovered </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> maps</span><span class="pun">=</span><span class="pln">$</span><span class="pun">(</span><span class="str">'#map_div'</span><span class="pun">).</span><span class="pln">children</span><span class="pun">();</span><span class="pln">

	</span><span class="kwd">var</span><span class="pln"> getSidePosition </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">x </span><span class="pun">/</span><span class="pln"> sectionSize</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> sectionSize </span><span class="pun">*</span><span class="pln"> ret </span><span class="pun">&lt;=</span><span class="pln"> diameter</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> ret </span><span class="pun">:</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> getPosition </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">self</span><span class="pun">).</span><span class="pln">offset</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> getSidePosition</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">pageX</span><span class="pun">-</span><span class="pln">offset</span><span class="pun">.</span><span class="pln">left</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> getSidePosition</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">.</span><span class="pln">pageY</span><span class="pun">-</span><span class="pln">offset</span><span class="pun">.</span><span class="pln">top</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">===-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> y</span><span class="pun">===-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">var</span><span class="pln"> colorize </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">which</span><span class="pun">,</span><span class="pln"> color</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">which</span><span class="pun">!==-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> $</span><span class="pun">(</span><span class="pln">maps</span><span class="pun">[</span><span class="pln">which</span><span class="pun">]).</span><span class="pln">css</span><span class="pun">({</span><span class="str">'background-color'</span><span class="pun">:</span><span class="pln"> color</span><span class="pun">});</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	$</span><span class="pun">(</span><span class="str">'#map_div'</span><span class="pun">).</span><span class="pln">mouseout</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
		colorize</span><span class="pun">(</span><span class="pln">hovered</span><span class="pun">,</span><span class="pln"> NONE_COLOR</span><span class="pun">);</span><span class="pln">
		hovered</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}).</span><span class="pln">click</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">){</span><span class="pln">
		colorize</span><span class="pun">(</span><span class="pln">selected</span><span class="pun">,</span><span class="pln"> NONE_COLOR</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> position</span><span class="pun">=</span><span class="pln">getPosition</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">selected</span><span class="pun">===</span><span class="pln">position</span><span class="pun">){</span><span class="pln">
			selected</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			selected</span><span class="pun">=</span><span class="pln">position</span><span class="pun">;</span><span class="pln">
			colorize</span><span class="pun">(</span><span class="pln">selected</span><span class="pun">,</span><span class="pln"> SELECTED_COLOR</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		hovered</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}).</span><span class="pln">mousemove</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">var</span><span class="pln"> pos</span><span class="pun">=</span><span class="pln">getPosition</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos</span><span class="pun">!==</span><span class="pln">hovered</span><span class="pun">){</span><span class="pln">
			colorize</span><span class="pun">(</span><span class="pln">hovered</span><span class="pun">,</span><span class="pln"> NONE_COLOR</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">!==</span><span class="pln"> selected</span><span class="pun">){</span><span class="pln">
				colorize</span><span class="pun">(</span><span class="pln">hovered </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">,</span><span class="pln"> HOVER_COLOR</span><span class="pun">);</span><span class="pln">	
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">});</span><span class="pln">
	colorize</span><span class="pun">(</span><span class="pln">selected</span><span class="pun">,</span><span class="pln"> SELECTED_COLOR</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span></pre>


</div></div>
</body>
</html>